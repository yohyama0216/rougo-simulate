# 老後資金シミュレーター

NISA積立 + 老後取り崩し + 老後月収シミュレーター

このウェブアプリケーションは、NISA積立シミュレーション、老後資金の取り崩しシミュレーション、および老後の月収計算を行うツールです。**初心者でも3分以内に結果が分かる**、使いやすいステップガイド式のシミュレーターです。

## 🚀 新機能（2026年1月更新）

### かんたんスタート（プリセット機能）
初めての方でも迷わず使える「プリセット」機能を追加しました：

- **ライフスタイル別プリセット**
  - 独身・賃貸
  - 独身・持ち家（住宅ローンあり）
  - 夫婦共働き
  - 夫婦・持ち家（住宅ローンあり）

- **運用スタイル別プリセット**
  - 保守的（低リスク・年利2%）
  - 標準（中リスク・年利4%）
  - 積極的（高リスク・年利6%）

プリセットを選ぶだけで、一般的な条件での試算結果をすぐに確認できます。その後、詳細を自由に調整可能です。

### ステップガイド式の入力
複雑な入力を4つのステップに分けました：

1. **かんたんスタート** - プリセットで即座に試算
2. **積立設定** - NISA積立の詳細設定（リアルタイムプレビュー付き）
3. **年金設定** - 年金額の計算（収入履歴から自動計算）
4. **結果確認** - 分かりやすい結果表示と改善アドバイス

各ステップで「戻る」「次へ」ボタンがあり、いつでも前のステップに戻って調整できます。

### 改善された結果画面
結果を一目で理解できるよう改善：

- **結論を大きく表示** - 「資金は持続する」or「不足する」を明確に
- **重要指標を3つに集約** - 老後月収、資産持続期間、退職時資産
- **改善アドバイス** - 資金不足の場合、具体的な改善策を提示
- **保存・共有機能** - URLで結果を保存・共有可能

## 主な機能

### 1. 積立（NISA）シミュレーション

#### 基本設定
- **初期資産**（円）：積立開始時点の資産額（デフォルト: 0円）
- **毎月積立額**（円）：毎月の積立金額（デフォルト: 100,000円）
- **積立期間**（年）：積立を続ける期間（デフォルト: 20年）
- **想定利回り**（年率%）：投資商品の期待リターン（デフォルト: 5.0%）
- **年間コスト**（年率%）：信託報酬等の費用（デフォルト: 0.2%）

#### 住宅ローン機能 🏠
途中で住宅を購入した場合のローン返済を考慮できます。

- **住宅ローンあり**：チェックボックスで有効化
- **ローン借入額**（円）：借入金額（デフォルト: 30,000,000円）
- **ローン金利**（年率%）：住宅ローンの金利（デフォルト: 1.5%）
- **ローン返済期間**（年）：返済期間（デフォルト: 35年）
- **ローン開始年**：積立開始から何年目にローンを開始するか（デフォルト: 1年目）

**計算方法**：標準的な元利均等返済方式を使用し、毎月のローン返済額を積立から自動的に差し引きます。

**例**：
- 住宅ローンなし：最終資産 ¥39,698,180
- 住宅ローンあり（¥30M、1.5%、35年）：最終資産 ¥3,292,846

#### 出力結果
- **最終資産**：積立期間終了時の総資産額
- **元本合計**：実際に積み立てた金額の合計
- **運用益**：投資による利益（最終資産 - 元本合計）
- **年別推移表**：各年の資産残高、元本累計、運用益を一覧表示

---

### 2. 取り崩しシミュレーション

#### 基本設定
- **退職時資産**（円）：取り崩し開始時の資産額（積立結果から自動連携可能）
- **取り崩し開始年齢**：資産の取り崩しを開始する年齢（デフォルト: 65歳）
- **取り崩し終了年齢**：資産を使い切る予定年齢（デフォルト: 95歳）
- **退職後想定利回り**（年率%）：退職後の資産運用リターン（デフォルト: 3.0%）

#### 介護費用機能 🏥
老後に介護が必要になった場合の費用を考慮できます。

- **介護費用あり**：チェックボックスで有効化
- **介護を受ける方**：夫または妻を選択
- **月額介護費用**（円）：デイケア、訪問介護等の費用（デフォルト: 100,000円）
- **介護開始年齢**：介護を開始する年齢（デフォルト: 75歳）

**計算方法**：現在価値法を使用して将来の介護費用を予約し、残りの資産から安全な取り崩し額を計算します。

#### 出力結果
- **枯渇しない月額取り崩し**：資産を枯渇させずに毎月受け取れる金額
- **年別残高推移表**：各年齢での資産残高と取り崩し額を表示
  - 介護費用がある場合は、介護開始年齢以降の年間取り崩し額に反映されます

---

### 3. 老後の月収

#### 世帯タイプ別年金計算 👨‍👩‍👧‍👦
日本の年金制度に基づいて、世帯構成に応じた適切な年金額を自動設定します。

**世帯タイプ選択肢**：

1. **夫のみ（会社員）**
   - 厚生年金のみ
   - デフォルト年金額: ¥150,000/月

2. **夫婦共働き（両方会社員）**
   - 夫婦それぞれが厚生年金
   - デフォルト年金額: ¥270,000/月
     - 夫: ¥150,000/月
     - 妻: ¥120,000/月

3. **妻がパート（第3号被保険者）**
   - 夫：厚生年金、妻：国民年金（扶養）
   - デフォルト年金額: ¥215,000/月
     - 夫: ¥150,000/月
     - 妻: ¥65,000/月（基礎年金）

4. **妻が個人事業主**
   - 夫：厚生年金、妻：国民年金
   - デフォルト年金額: ¥215,000/月
     - 夫: ¥150,000/月
     - 妻: ¥65,000/月（基礎年金）

#### 年金の入力方法 💰

**2つの入力方式**を選択できます：

1. **年金額を直接入力**
   - 年金額が分かっている場合に使用
   - 手動で月額年金を入力

2. **現在の年収から計算** ⭐ NEW!
   - 現役時代の平均年収から年金額を自動計算
   - 以下の情報を入力：
     - **平均年収（税込）**：現役時代の平均的な年収
     - **加入期間（年）**：厚生年金または国民年金の加入年数
   - 計算式が画面に表示されるので、計算根拠が明確

**年金計算式**：

- **厚生年金**（会社員）
  ```
  月額年金 = 国民年金（基礎年金）+ 厚生年金部分
  厚生年金部分の年額 = 平均月収 × 0.005481 × 加入月数
  月額年金 = 基礎年金 + (厚生年金部分の年額 / 12)
  ```
  - 給付乗率: 0.005481（2003年4月以降の報酬に適用）

- **国民年金**（基礎年金）
  ```
  月額年金 = ¥68,000 × (加入年数 / 40年)
  ```
  - 満額（40年加入）: ¥68,000/月（2024年度）

**例**：
- 平均年収 ¥5,000,000、40年加入 → 月額約¥159,350
  - 基礎年金: ¥68,000
  - 厚生年金部分: ¥91,350

**注意**：
- 計算は簡略化されており、実際の年金額とは異なる場合があります
- 年金額は個々の状況に応じて調整可能です

#### 出力結果
- **老後月収合計**：公的年金 + 取り崩し額の合計
- **内訳表示**：
  - 公的年金（月額）
  - 資産取り崩し（月額）

---

## 計算式・計算方法

### 月利換算
年率 `r` の月利 = `(1 + r)^(1/12) - 1`

### 積立計算（複利計算）
```
各月の処理:
1. 利息を付ける: 残高 = 残高 × (1 + 月利)
2. 積立を追加: 残高 = 残高 + 毎月積立額
3. ローン返済: 残高 = 残高 - 月額ローン返済額（該当期間のみ）
```

### 住宅ローン返済額計算（元利均等返済）
```
月額返済額 = 借入額 × [月利 × (1 + 月利)^返済月数] / [(1 + 月利)^返済月数 - 1]
```

### 取り崩し計算（年金現価係数）
```
枯渇しない月額 = 退職時資産 / [(1 - (1 + 月利)^-総月数) / 月利]

介護費用がある場合:
1. 将来の介護費用の現在価値を計算
2. 退職時資産から介護費用分を差し引いた額で月額を計算
```

---

## 📱 使い方（3分でできる老後資金診断）

### 初めての方へ（推奨手順）

1. **プリセットを選ぶ（30秒）**
   - あなたの状況に近いライフスタイルを選択
   - または運用スタイルを選択
   - すぐに概算結果が表示されます

2. **積立条件を調整（1分）**
   - 初期資産、毎月の積立額を実際の数値に変更
   - 住宅ローンがある場合はチェックボックスをON
   - リアルタイムで結果プレビューが更新されます

3. **年金情報を入力（1分）**
   - 世帯タイプを選択（独身/共働き/扶養家族あり）
   - 平均年収と勤続年数を入力
   - 年金額が自動計算されます

4. **結果を確認（30秒）**
   - 老後の月収、資産の持続期間を確認
   - 不足がある場合は改善アドバイスを参照
   - URLをコピーして保存

### 詳細入力から始める場合

プリセット画面で「プリセットを使わず、詳細入力から始める」をクリックすると、従来通りの詳細設定から開始できます。

---

## 使い方

### 1. 積立シミュレーション
1. 「積立（NISA）」タブを開く
2. 初期資産、毎月積立額、期間、利回りを入力
3. 住宅ローンがある場合はチェックボックスをONにして詳細を入力
4. 即座に最終資産と年別推移が表示されます

### 2. 取り崩しシミュレーション
1. 「取り崩し」タブを開く
2. 「積立結果を使用」ボタンで積立の最終資産を自動入力
3. 開始・終了年齢、退職後利回りを入力
4. 介護費用が必要な場合はチェックボックスをONにして詳細を入力
5. 枯渇しない月額取り崩し額が表示されます

### 3. 老後月収の確認
1. 「老後の月収」タブを開く
2. 世帯タイプを選択（年金額が自動設定されます）
3. 必要に応じて年金額を調整
4. 年金 + 取り崩しの合計月収が表示されます

---

## 技術スタック

- **フロントエンド**: React 19 + TypeScript
- **ビルドツール**: Vite
- **スタイリング**: Bootstrap 5.3.0（CDN）
- **デプロイ**: GitHub Pages（GitHub Actions自動デプロイ）

---

## ローカル開発

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動
npm run dev

# ビルド
npm run build

# リント
npm run lint
```

---

## デプロイ

### GitHub Pagesへのデプロイ

このプロジェクトは GitHub Pages に自動デプロイされます。

#### 初回セットアップ（リポジトリ管理者向け）

GitHub Pages を有効にするには、以下の手順を実行してください：

1. リポジトリの **Settings** → **Pages** に移動
2. "Build and deployment" セクションで：
   - **Source**: "GitHub Actions" を選択
3. 設定を保存

#### 自動デプロイの仕組み

- `main` ブランチに push すると、GitHub Actions が自動的に実行されます
- ワークフローは以下を実行します：
  1. 依存関係のインストール（`npm ci`）
  2. プロジェクトのビルド（`npm run build`）
  3. GitHub Pages への自動デプロイ
- デプロイ先: `https://yohyama0216.github.io/rougo-simulate/`

#### トラブルシューティング

**エラー: "Failed to create deployment (status: 404)"**

このエラーが表示される場合、GitHub Pages が有効になっていない可能性があります。上記の初回セットアップ手順を実行してください。

---

## 使用例

### ケース1: 住宅ローンなしで積立のみ
- 毎月10万円を20年間積立
- 利回り5%、コスト0.2%
- **結果**: 最終資産 ¥39,698,180

### ケース2: 住宅ローンありで積立
- 毎月10万円を20年間積立
- 住宅ローン3000万円（1.5%、35年、1年目開始）
- **結果**: 最終資産 ¥3,292,846（ローン返済の影響大）

### ケース3: 介護費用を考慮した取り崩し
- 退職時資産 ¥39,698,180
- 65歳～95歳（30年間）
- 75歳から月10万円の介護費用
- **結果**: 介護費用を差し引いた安全な月額取り崩し額を計算

### ケース4: 夫婦共働きの老後月収
- 公的年金: ¥270,000/月（夫婦合計）
- 取り崩し: ¥166,504/月
- **結果**: 老後月収 ¥436,504/月

---

## 注意事項

⚠️ **重要**: このシミュレーターは参考値です。実際の運用成果を保証するものではありません。

- 計算結果は入力された条件に基づく理論値です
- インフレ率は考慮されていません
- 税金や手数料は簡略化されています
- 実際の投資判断は専門家にご相談ください

---

## ライセンス

MIT License

---

## 将来の拡張予定

- グラフ表示（資産推移の可視化）
- 複数シナリオの比較機能
- インフレ率の考慮
- 入力値の保存機能（URL/ローカルストレージ）
- 取り崩し方式の追加（定率、4%ルールなど）

